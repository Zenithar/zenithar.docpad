<!DOCTYPE html><html lang="fr"><head><!--Meta--><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta http-equiv="content-type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Zenithar.org - De ActiveMQ vers XMPP : mais pourquoi j'y ai pas pensé plus tôt ?</title><meta name="description" content="Ancien ingénieur sécurité passionné, acteur dans le monde du logiciel 'libre'. Je suis en veille technologique permanente car toujours à la recherche du 'meilleur tournevis'." /><meta name="keywords" content="zenithar, toulouse, java, security, engineer, activemq, apache, ebml, message, queue, XMPP" /><meta name="author" content="Thibault NORMAND" /><!--Icons--><link rel="shortcut icon" href="images/favicon.ico" /><link rel="apple-touch-icon" href="images/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" /><link rel="alternate" type="application/atom+xml" title="Zenithar.org &raquo; Feed" href="http://feeds.feedburner.com/ZenitharOrg" /><!--Shims: IE6-8 support of HTML5 elements--><!--[if lt IE 9]>
        <script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><!--Styles--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" media="screen, projection" /><link rel="stylesheet" href="/styles/style.css" media="screen, projection" /><link rel="stylesheet" href="/styles/markdown.css" media="screen, projection" /><link rel="stylesheet" href="http://yandex.st/highlightjs/7.3/styles/github.min.css" media="screen, projection" /><!--Scripts--><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script><script src="//connect.facebook.net/fr_FR/all.js#xfbml=1"></script><script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script></head><body><!--Topbar--><div class="navbar navbar-static-top"><div class="navbar-inner"><div class="container"><a class="btn btn-navbar pull-right" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="/">Zenithar.org</a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/site/tagmap.html">Tagmap</a></li><li><a href="/site/archive.html">Archives</a></li><li><a href="http://zenithar.org" rel="me">CV</a></li><li><a href="http://feeds.feedburner.com/ZenitharOrg"><img src="/images/rss_32.png" style="width: 24px" /></a></li></ul><form id="search-form" class="pull-right navbar-search" action="http://google.com/search" method="get"><input type="hidden" name="q" value="site:www.zenithar.org" /><input type="text" name="q" results="0" placeholder="Search" search-query /></form></div></div></div></div><!--Markup--><div class="container"><div><script src="http://platform.twitter.com/widgets.js"></script><script>//facebook
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

//google plusone
(function() {
  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
  po.src = 'https://apis.google.com/js/plusone.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script><section class="content"><article id="post" class="post" typeof="sioc:post" about="/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html" lang="fr-fr"><div class="row"><div class="span2 muted modern-font small-font"><span property="dc:created">2009 févr. 24 &raquo;</span></div><div class="span10"><h1 property="dcterms:title">De ActiveMQ vers XMPP : mais pourquoi j'y ai pas pensé plus tôt ?</h1></div></div><div class="row"><div class="offset2 span10 modern-font small-font muted"><span>&nbsp; par <a href="https://twitter.com/zenithar/">Thibault NORMAND</a></span>
 | <a href="/site/tagmap.html#activemq" class="tag">activemq</a> <a href="/site/tagmap.html#apache" class="tag">apache</a> <a href="/site/tagmap.html#ebml" class="tag">ebml</a> <a href="/site/tagmap.html#message" class="tag">message</a> <a href="/site/tagmap.html#queue" class="tag">queue</a> <a href="/site/tagmap.html#xmpp" class="tag">XMPP</a> | <span><a href="/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html#disqus_thread" data-disqus-identifier="/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html"></a></span>
</div></div><div class="row"><div class="span2"><style rel="stylesheet" media="screen, projection" scoped="scoped">#social-buttons {
  margin-left: 30px;
}</style><div id="social-buttons" class="pull-right"><ul class="unstyled"><li><a class="twitter-share-button" href="https://twitter.com/share" data-url="http://www.zenithar.org/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html" data-via="zenithar" data-count="horizontal" data-lang="fr">Tweet</a></li><li><div class="g-plusone" data-size="medium" data-href="http://www.zenithar.org/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html"></div></li><li><div class="fb-like" data-href="http://www.zenithar.org/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html" data-send="false" data-layout="button_count" data-show-faces="false"></div></li></ul></div></div><div class="span10"><div property="sioc:content"><p><img src="http://static.zenithar.org/wp-content/uploads/2009/02/xmpp.png" alt="xmpp"/></p>

<p>Suite à des projets personnels et professionnels, j'ai été confronté à une problématique de communication inter-processus (temps réel ou pas !). Ces agents devaient effectuer un traitement bien spécifique sur l'information qui transitait sur le bus de distribution du message.</p>

<p>Je travaille sur un système de monitoring multiple ressources, multisites, et surtout multiple-évènements. J'utilisais comme transport sur mon bus d'évènement une file Apache ActiveMQ, cependant je me suis retrouvé dans le cas où je devais programmer des fonctions de monitoring inter-agents.</p>

<p>Chaque agent expose sa présence à la connexion au bus. C'est le manager qui surveille le système à l'aide de messages envoyés via un bus de contrôle.</p>

<p>Pour en revenir à nos moutons, pourquoi parler de XMPP ? Tout simplement parce que c'est un protocole tellement simple : seulement 3 types de messages (synchrone, asynchrone, présence). Que ce protocole possède des spécifications ouvertes : il est à l'origine du protocole Jabber.<br/>
Après analyse, je me suis aperçu que j'avais codé exactement le comportement de XMPP (les trois types de message), alors je me suis dis pourquoi pas tout migrer sur du XMPP ? [Et c'est à ce moment que quelqu'un me dit toujours que je suis un grand malade !] Ce que j'ai fait. Aujourd'hui la technologie apporte les solutions à des problèmes bien précis, et j'avoue je me régale toujours à détourner les fonctionnalités de ces technologies pour résoudre mes problèmes.</p>

<h2>Problématiques :</h2>

<ul>
<li>Comment distribuer les messages à un agent en particulier ?</li>
<li>Comment distribuer les messages à un groupe d'agent ?<br/></li>
<li>Comment connaître l'état d'un agent ?</li>
<li>Comment savoir si un agent est connecté au système ?</li>
</ul>

<p>Voici les problématiques que j'ai résolu via l'utilisation du protocole XMPP comme bus de communication.</p>

<p><em>1. Comment distribuer les messages à un agent en particulier ?</em><br/>
Les messages émis sur le bus sont nominatifs, c-à-d qu'ils ont une source et une destination.</p>

<p><em>2. Comment distribuer les messages à un groupe d'agent ?</em><br/>
Les messages peuvent être transmis à des groupes de contacts (buddy), ou il est possible de simuler un &ldquo;broadcast&rdquo; de message via l'utilisation d'un salon privé de conférence, espèce de canal IRC mais pour Jabber.</p>

<p><em>3. Comment connaître l'état d'un agent ?</em><br/>
L'état de l'agent (disponible, occupé, etc&hellip;) correspond à l'information de statut associée à la présence du contact sur le réseau.</p>

<p><em>4. Comment savoir si un agent est connecté au système ?</em><br/>
Le protocole XMPP gère les présences des agents sur le réseau. A la connexion d'un agent, celui ci informe tous les autres de sa présence.</p>

<h2>Quels sont les avantages ?</h2>

<ul>
<li>Le système est bcp plus réactif, les messages sont visibles dans un protocole exploitable par tous les agents capables de comprendre le XMPP. Il sera possible de créer des agents dans différents langages.<br/></li>
<li>Le système permet des communications multi-sites, en effet XMPP permet le routage des messages inter-serveurs (voir fonctionnement Jabber entre 2 domaines différents).</li>
<li>Il n'est pas nécessaire d'avoir un serveur de file d'attente sur la machine.</li>
<li>Protocole ouvert et extensible, tout peut être transporté dans le flux XML.</li>
</ul>

<h2>Quels sont les inconvénients ?</h2>

<ul>
<li>Il est nécessaire d'installer un serveur Jabber (Openfire ou eJabberd). Personnellement j'utilise eJabberd, qui possède des fonctionnalités de clustering plutôt impressionnante. D'ailleurs faudrait que je jette un oeil sur ce langage Erlang.<br/></li>
<li>Nécessite la connaissance du protocole XMPP un minimum, alors qu'avec les MQ (MessageQueue) traditionnelle c'est transparent.</li>
<li>Interaction avec un client Jabber traditionnel : peut être aussi un avantage, mais moi je vois une possibilité de détournement, (boh c'est le consultant sécu qui parle là !)</li>
<li>Il est possible que par l'utilisation du XML comme descripteur du protocole on obtienne une surcharge d'informations inutiles dans les messages.</li>
</ul>

<h2>Quelques idées sur le papier numérique :</h2>

<p>Il serait agréable d'avoir un standard de communication permettant d'agréger de manière simple et unique tout les protocoles réseaux. Jabber contient le concept de passerelle permettant de &ldquo;traduire&rdquo; du MSN en XMPP.</p>

<p>Pourquoi ne pas faire une passerelle SNMP / XMPP, CMMI / XMPP pour les protocoles d'interrogations des devices. Il existe déja du XMLRPC over XMPP et du SOAP over XMPP, ce qui montre bien que XMPP est un protocole de transport tout comme le HTTP.</p>

<p>Je serais d'avis de travailler dans le sens de réduire la taille d'un paquet XMPP, en le passant en octet comme avec l'EBML utilisé pour le conteneur numérique Matrovska (MKV). Cependant cherche-t-on a avoir un protocole rapide ou plutôt facile d'utilisation et surtout facile à implémenter (Un parseur XML suffit et en avant Guingamp !). Il me semble avoir entendu parlé du XMPP en utilisant du YAML, qui est un langage qui se base sur les tabulations plutôt que le couple de balise ouverture/fermeture. Il n'y a pas de fermeture de balise, il suffit de revenir d'un cran pour fermer le contexte en cours.</p>

<p>Voila je termine ce long post qui je pense doit être le plus long que mon blog n'ai jamais eut ! A vous les commentaires !</p>
</div></div></div></article></section><section id="related"><div class="row"><div class="offset2 span10"><h3>Autre(s) article(s)</h3><ul><li><span>2005 août 10</span>&nbsp;&raquo;&nbsp;<a href="/articles/2005-08-10-jabber-open-instant-messaging-and-a-whole-lot-more-powered-by-xmpp.html">Jabber: Open Instant Messaging and a Whole Lot More, Powered by XMPP</a></li><li><span>2009 sept. 09</span>&nbsp;&raquo;&nbsp;<a href="/articles/2009-09-09-mise-en-place-dune-infrastructure-de-service-web.html">Mise en place d'une infrastructure de service Web</a></li><li><span>2011 mai 06</span>&nbsp;&raquo;&nbsp;<a href="/articles/2011-05-06-pourquoi-je-nutiliserai-plus-struts-2-a-lavenir.html">Pourquoi je n'utiliserai plus Struts 2 à l'avenir ...</a></li><li><span>2011 mai 21</span>&nbsp;&raquo;&nbsp;<a href="/articles/2011-05-21-zeromq-ca-roxe-du-poney.html">ZeroMQ, ça roxe du poney !</a></li></ul></div></div></section><section id="comments"><div class="row"><div class="offset2 span10"><h3>Commentaire(s)</h3><div id="disqus_thread" class="well"></div>
<script type="text/javascript">
    var disqus_shortname = 'zenithar';
    var disqus_identifier = '/articles/2009-02-24-de-activemq-vers-xmpp-mais-pourquoi-jy-ai-pas-pense-plus-tot.html';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div></section></div></div><footer class="footer"><div class="container"><div class="row"><p>Copyright &copy; 2005-2013 Thibault NORMAND, motorisé par <a href="https://github.com/balupton/docpad">Docpad</a>, versionné par <a href="https://github.com/Zenithar/zenithar.docpad">Github</a>.</p></div></div></footer><!--DISQUS--><script>var disqus_shortname = 'zenithar';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());</script><!--GA--><script>if( 'http://www.zenithar.org' === 'http://' + window.location.hostname ) {
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-8114245-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}</script></body></html>